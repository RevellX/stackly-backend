@model StacklyBackend.Models.Group
@using Microsoft.CodeAnalysis.Differencing
@{
    var error = ViewData["Error"] as string;
    ViewData["Title"] = "Edit";
}
<h2>Group - @ViewData["Title"]</h2>
<a href="/group"><button type="button" aria-label="Go back">Go to list</button></a>
<p>Item form: </p>

@if (!string.IsNullOrEmpty(error))
{
    <div role="alert" class="validation-summary-errors">
        @error
    </div>
}

<form action="/group/edit/@Model.Id" method="post">
    @Html.AntiForgeryToken()
    <input type="hidden" id="Id" name="Id" value="@Model.Id" />
    <div>
        <label for="Name">Name</label>
        <input type="text" id="Name" name="Name" value="@Model?.Name"/>
    </div>
    <button type="submit">Edit</button>
</form>
<form action="/group/addUser" method="post">
    <div>
        <label for="AddUserEmail">AddUserEmail</label>
        <input type="hidden" name="GroupId" value="@Model!.Id" />
        <input type="text" id="AddUserEmail" Name="AddUserEmail"/>
        <button type="submit">Add</button>
    </div>
</form>
    <ul>Users in group:
    @foreach (User user in Model?.Users.ToArray() ?? Array.Empty<StacklyBackend.Models.User>())
    {
        <li>
        <span>@user.Email</span>
        <form action="/group/removeUser" method="post">
            <input type="hidden" name="GroupId" value="@Model!.Id" />
            <input type="hidden" id="RemoveUserEmail" name="RemoveUserEmail" value="@user.Email"/>
            <button type="submit"><i class="fa-solid fa-trash"></i></button>
        </form>
        </li>
    }
    </ul>