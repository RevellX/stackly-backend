@model StacklyBackend.Models.Category

@{
    ViewData["Title"] = "Edit Category";
    
    // BEZLITOSNA PRAWDA O DANYCH:
    // W ItemController masz gotowy obiekt SelectList w ViewData.
    // Tutaj masz surową listę obiektów Group. Musisz to zamienić na SelectList tutaj,
    // bo inaczej 'form-select-builder' dostanie nulla i nic nie wyświetli.
    var rawGroups = ViewData["groups"] as IEnumerable<StacklyBackend.Models.Group> 
                    ?? Enumerable.Empty<StacklyBackend.Models.Group>();
                    
    // Tworzymy SelectList ręcznie: (źródło, pole wartości, pole tekstu, wybrana wartość)
    var groupSelectList = new SelectList(rawGroups, "Id", "Name", Model.GroupId);
}

@section Styles {
    <link rel="stylesheet" href="~/css/forms.css" />
    <link rel="stylesheet" href="~/css/tables.css" />
}

<div class="entry-section">
    <a href="/category" class="btn-back" aria-label="Go back">
        <i class="fa-solid fa-chevron-left"></i>
    </a>
    <h2>Edit - @Model.Name</h2>
</div>

<div class="info-section">
    <p>Update category details below.</p>
</div>

<div class="form-container">
    <form-builder controller="Category" action="Edit" method="post">
        
        <input type="hidden" name="Id" value="@Model.Id" />

        <form-input-builder for="Name">
            Name
        </form-input-builder>

        <form-select-builder 
            for="GroupId" 
            items="@groupSelectList"
            option-label="-- Select Group --">
            Assigned Group
        </form-select-builder>

        <div class="form-actions" style="margin-top: 2rem;">
            <form-submit-builder>Save Changes</form-submit-builder>
        </div>
        
    </form-builder>
</div>